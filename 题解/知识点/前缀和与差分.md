# 前缀和与差分

### 前言

​	前缀和与差分 这两个算法都是用于优化的，属于一种技巧，前者用于求区间和，后者用于区间修改。

## 前缀和

### 定义

​	可以理解为[数列的前N项]，是一种重要的预处理方式。

我们在这篇里就先简单的只讲解一维前缀和啦awa~

### 理论讲解 

​	对于一个长度为 N 的数列 $A = {A_1, A_2, ..., A_n}$ 来说， 我们在高中学习过【数列的前N项和】， 即 $S_i = \sum_{k = 1}^i A_i$，这个$S_i$，本质上就是前缀和了，那么我们怎么求$[l, r]$区间内的和呢？

​	形式上的讲：我们要求 $\sum_{i=l}^r A_i$ 。

​	通常的想法是这样的，我们从 $A_l$ 枚举到 $A_r$，把每一位加起来，就求出了我们要的值！但是这样来算时间的话 我们枚举了 $r-l$ 次， 所以时间复杂度是$O(l-r)$

​	但是如果我们借助【前N项和】呢？

​	我们就可以通过 $S_r - S_{l - 1}$ ，直接求出我们要的值了！ 这样来看时间的话， 我们是直接调用了两个数字，一次运算得出答案！ 时间复杂度是 $O(1)$。

> [!warning]
>
> 一定是 $S_{l-1}$，因为 $S_l$是包含了 $A_l$的，如果不 -1 的话，就会少计算 $A_l$这一项了！

### 代码实现！

​	这么简单还想要代码？不给！

## 差分

### 定义

​	差分是一种与前缀和相对的策略，是前缀和的逆运算。相较于给定某一序列求它的差分，竞赛中更为常见的情景是，通过维护差分序列的信息，实现多次区间修改。在区间修改结束后，可以通过前缀和恢复原序列的信息，实现对原序列的查询。注意修改操作一定要在查询操作之前。   ---选自 OI-WIKI（因为我懒得写了）

​	形式化的讲！ 差分是前缀和的 逆运算！ 表示 变化量 ($\Delta x$)！

我们这里也只简单的介绍一维差分数组

### 理论讲解

​	对于一个数列 ${A_i}$, 他的差分序列是 ${D_i} = A_i - A_{i - 1}, A_0 = 0$。

​	与前缀和的关系如下：

> [!note]
>
> 如果 $D_i$ 是 $A_i$ 的差分序列，那么有：
>
> ·序列$A_i$是$D_i$的前缀和，即
>
> ​	$A_i = \sum_{j=1}^i D_i$
>
> ·序列$A_i$的前缀和为
>
> ​	$S_i = \sum_{j=1}^i\sum_{k=1}^j D_k = \sum_{j=1}^i (i - j + 1) D_j$

​	差分信息常常用于维护多次对序列的一个区间加上一个数，并在之后一次或多次询问序列某一位的取值。

​	假设要对 $A_i$ 在 区间[l, r] 上每个数都加上一个 v 。那么他的写法应当是 ： $D_l$ <- $D_l$ + $v$, $D_{r +1}$ <- $D_{r +1}$ - $v$ 。

> [!warning]
>
> 一定是 $D_{r+1}$ ，因为你要对 [l ,r ] 之间加上 v， 那么你修改的对象最后一个是 $D_r$ ,因此 在 r + 1及之后，去掉这个 v 变化量！

​	差分数组构造结束之后，要对其做一次前缀和，才可以变成真正的数组样子哦！，可以自己简单的用数学推导一下，这里不想告诉你了！

### 代码实现

​	下次一定！